name: file-validator
type: shell
description: File validation tool for checking output files and directories
parameters:
  check_path:
    type: str
    required: true
    help: "Path to check for files"
  expected_files:
    type: list
    required: true
    help: "List of expected file patterns"
  min_size:
    type: int
    default: 0
    help: "Minimum file size in bytes"
  recursive:
    type: bool
    default: true
    help: "Whether to search recursively"
command_template: >
  {% if recursive %}
  find {{ check_path }} -name "{{ expected_files[0] }}" -size +{{ min_size }}c -type f
  {% else %}
  find {{ check_path }} -maxdepth 1 -name "{{ expected_files[0] }}" -size +{{ min_size }}c -type f
  {% endif %}
success_pattern: "{{ check_path }}"
timeout: 30
validation:
  exit_code: 0
  stdout_contains: ["{{ check_path }}"]
post_exec:
  outputs:
    found_files: "find_latest_file(dir='{{ check_path }}', pattern='{{ expected_files[0] }}')"
    files_exist: "check_file_exists(path='{{ check_path }}')"
    file_count: "len(glob.glob(os.path.join('{{ check_path }}', '{{ expected_files[0] }}')))"